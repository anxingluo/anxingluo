(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50509c6a"],{"0f53":function(t,e,a){},"25ae":function(t,e,a){
/*! For license information please see ckeditor.js.LICENSE.txt */
/*!*
* @license Copyright (c) 2003-2022, CKSource Holding sp. z o.o. All rights reserved.
* For licensing, see LICENSE.md.
*/
!function(e,a){t.exports=a()}(window,(function(){return function(t){var e={};function a(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=t,a.c=e,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="",a(a.s=0)}([function(t,e,a){t.exports=a(1)},function(t,e,a){"use strict";function n(t,e){t.onload=function(){this.onerror=this.onload=null,e(null,t)},t.onerror=function(){this.onerror=this.onload=null,e(new Error("Failed to load "+this.src),t)}}function r(t,e){t.onreadystatechange=function(){"complete"!=this.readyState&&"loaded"!=this.readyState||(this.onreadystatechange=null,e(null,t))}}var o;function i(t,e){return"CKEDITOR"in window?Promise.resolve(CKEDITOR):"string"!=typeof t||t.length<1?Promise.reject(new TypeError("CKEditor URL must be a non-empty string.")):(o||(o=i.scriptLoader(t).then((function(t){return e&&e(t),t}))),o)}a.r(e),i.scriptLoader=function(t){return new Promise((function(e,a){!function(t,e,a){var o=document.head||document.getElementsByTagName("head")[0],i=document.createElement("script");"function"==typeof e&&(a=e,e={}),e=e||{},a=a||function(){},i.type=e.type||"text/javascript",i.charset=e.charset||"utf8",i.async=!("async"in e)||!!e.async,i.src=t,e.attrs&&function(t,e){for(var a in e)t.setAttribute(a,e[a])}(i,e.attrs),e.text&&(i.text=String(e.text)),("onload"in i?n:r)(i,a),i.onload||n(i,a),o.appendChild(i)}(t,(function(t){return o=void 0,t?a(t):window.CKEDITOR?void e(CKEDITOR):a(new Error("Script loaded from editorUrl doesn't provide CKEDITOR namespace."))}))}))};var s={name:"ckeditor",render(t){return t("div",{},[t(this.tagName)])},props:{value:{type:String,default:""},type:{type:String,default:"classic",validator:t=>["classic","inline"].includes(t)},editorUrl:{type:String,default:"https://cdn.ckeditor.com/4.17.2/standard-all/ckeditor.js"},config:{type:Object,default:()=>{}},tagName:{type:String,default:"textarea"},readOnly:{type:Boolean,default:null},throttle:{type:Number,default:80}},mounted(){i(this.editorUrl,t=>{this.$emit("namespaceloaded",t)}).then(()=>{if(this.$_destroyed)return;const t=this.prepareConfig(),e="inline"===this.type?"inline":"replace",a=this.$el.firstElementChild;CKEDITOR[e](a,t)})},beforeDestroy(){this.instance&&this.instance.destroy(),this.$_destroyed=!0},watch:{value(t){this.instance&&this.instance.getData()!==t&&this.instance.setData(t)},readOnly(t){this.instance&&this.instance.setReadOnly(t)}},methods:{prepareConfig(){const t=this.config||{};t.on=t.on||{},void 0===t.delayIfDetached&&(t.delayIfDetached=!0),null!==this.readOnly&&(t.readOnly=this.readOnly);const e=t.on.instanceReady;return t.on.instanceReady=t=>{this.instance=t.editor,this.$nextTick().then(()=>{this.prepareComponentData(),e&&e(t)})},t},prepareComponentData(){const t=this.value;this.instance.fire("lockSnapshot"),this.instance.setData(t,{callback:()=>{this.$_setUpEditorEvents();const e=this.instance.getData();t!==e?(this.$once("input",()=>{this.$emit("ready",this.instance)}),this.$emit("input",e)):this.$emit("ready",this.instance),this.instance.fire("unlockSnapshot")}})},$_setUpEditorEvents(){const t=this.instance,e=function(t,e){var a,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(){clearTimeout(a);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];a=setTimeout(t.bind.apply(t,[n].concat(o)),e)}}(e=>{const a=t.getData();this.value!==a&&this.$emit("input",a,e,t)},this.throttle);t.on("change",e),t.on("focus",e=>{this.$emit("focus",e,t)}),t.on("blur",e=>{this.$emit("blur",e,t)})}}};const c={install(t){t.component("ckeditor",s)},component:s};e.default=c}]).default}))},"25f0":function(t,e,a){"use strict";var n=a("6eeb"),r=a("825a"),o=a("d039"),i=a("ad6d"),s="toString",c=RegExp.prototype,u=c[s],l=o((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),d=u.name!=s;(l||d)&&n(RegExp.prototype,s,(function(){var t=r(this),e=String(t.source),a=t.flags,n=String(void 0===a&&t instanceof RegExp&&!("flags"in c)?i.call(t):a);return"/"+e+"/"+n}),{unsafe:!0})},"2ea3":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"addNav"},[a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary",plain:""},on:{click:t.hideAddPage}},[t._v("返回商品列表")]),a("el-alert",{attrs:{title:"add"==t.addOpenType?"添加商品信息":"修改商品信息",type:"info",center:"","show-icon":"",closable:!1}})],1),a("el-steps",{staticStyle:{"margin-top":"20px"},attrs:{active:parseInt(t.active),"finish-status":"success","align-center":""}},[a("el-step",{attrs:{title:"基本信息"},nativeOn:{click:function(e){return t.setsBut({value:"0"})}}}),a("el-step",{attrs:{title:"商品参数"},nativeOn:{click:function(e){return t.setsBut({value:"1"})}}}),a("el-step",{attrs:{title:"商品属性"},nativeOn:{click:function(e){return t.setsBut({value:"2"})}}}),a("el-step",{attrs:{title:"商品图片"},nativeOn:{click:function(e){return t.setsBut({value:"3"})}}}),a("el-step",{attrs:{title:"商品内容"},nativeOn:{click:function(e){return t.setsBut({value:"4"})}}})],1),a("el-tabs",{staticStyle:{"margin-top":"20px"},attrs:{"tab-position":"left","before-leave":t.tabBeforeLeave},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[a("el-tab-pane",{attrs:{label:"基本信息",name:"0"}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm1,rules:t.rules1,"label-width":"200px","status-icon":"","label-position":"top"}},[a("el-form-item",{attrs:{label:"商品名称",prop:"goods_name"}},[a("el-input",{model:{value:t.ruleForm1.goods_name,callback:function(e){t.$set(t.ruleForm1,"goods_name",e)},expression:"ruleForm1.goods_name"}})],1),a("el-form-item",{attrs:{label:"商品价格(元)",prop:"goods_price"}},[a("el-input",{attrs:{type:"number"},model:{value:t.ruleForm1.goods_price,callback:function(e){t.$set(t.ruleForm1,"goods_price",t._n(e))},expression:"ruleForm1.goods_price"}})],1),a("el-form-item",{attrs:{label:"商品重量(kg)",prop:"goods_weight"}},[a("el-input",{attrs:{type:"number"},model:{value:t.ruleForm1.goods_weight,callback:function(e){t.$set(t.ruleForm1,"goods_weight",t._n(e))},expression:"ruleForm1.goods_weight"}})],1),a("el-form-item",{attrs:{label:"商品数量",prop:"goods_number"}},[a("el-input",{attrs:{type:"number"},model:{value:t.ruleForm1.goods_number,callback:function(e){t.$set(t.ruleForm1,"goods_number",t._n(e))},expression:"ruleForm1.goods_number"}})],1),a("el-form-item",{attrs:{label:"商品分类",prop:"goods_cat"}},[a("el-input",{staticStyle:{width:"0",height:"0"},attrs:{type:"hidden"},model:{value:t.ruleForm1.goods_cat,callback:function(e){t.$set(t.ruleForm1,"goods_cat",e)},expression:"ruleForm1.goods_cat"}}),a("goodsCascaderCom",{staticStyle:{width:"100%"},attrs:{casValue:t.resCasValue,casOption:t.options,casDataType:t.dataType},on:{clickValue:t.casChange}})],1)],1)],1),a("el-tab-pane",{attrs:{label:"商品参数",name:"1"}},[0!=t.manyAtt.length?a("el-form",{ref:"manyFrom",attrs:{"label-width":"100px","label-position":"top"}},t._l(t.manyAtt,(function(e){return a("el-form-item",{key:e.attr_id,attrs:{label:e.attr_name}},t._l(e.attr_value,(function(n){return a("el-tag",{key:n,staticStyle:{"margin-left":"20px"},attrs:{closable:"",effect:"dark"},on:{close:function(){return e.attr_value.splice(e.attr_value.indexOf(n),1)}}},[t._v(" "+t._s(n)+" ")])})),1)})),1):t._e(),0==t.manyAtt.length?a("el-empty",{attrs:{description:"该分类没有商品参数"}}):t._e()],1),a("el-tab-pane",{attrs:{label:"商品属性",name:"2"}},[0!=t.onlyAtt.length?a("el-form",{ref:"onlyFrom",attrs:{"label-width":"100px","label-position":"top"}},[t._l(t.onlyAtt,(function(e){return a("el-form-item",{key:e.attr_id,attrs:{label:e.attr_name}},[a("el-input",{attrs:{placeholder:"请输入内容"},model:{value:e.attr_value,callback:function(a){t.$set(e,"attr_value",a)},expression:"onlyItem.attr_value"}})],1)})),0==t.onlyAtt.length?a("el-empty",{attrs:{description:"该分类没有商品属性"}}):t._e()],2):t._e()],1),a("el-tab-pane",{attrs:{label:"商品图片",name:"3"}},[a("el-upload",{ref:"goodsImgUpload",staticClass:"upload-demo",staticStyle:{"margin-bottom":"10px"},attrs:{action:t.baseUrl+"/upload",headers:{Authorization:t.urlTOkent},"auto-upload":!1,"list-type":"picture","file-list":t.defaultList,"before-upload":function(){return t.isUpload=!0},"on-remove":t.removeSuccGoods,"on-change":t.goodsImgChange,"on-error":t.goodsImgError,"on-success":t.goodsImgSuccess,drag:"",limit:10}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("最多只能上传10个jpg/png文件，且每个文件不超过500kb。")])])],1),a("el-tab-pane",{attrs:{label:"商品内容",name:"4"}},[a("ckEditor",{attrs:{config:t.editConfig},model:{value:t.goods_introduce,callback:function(e){t.goods_introduce=e},expression:"goods_introduce"}})],1)],1),a("div",{staticStyle:{"text-align":"center","margin-top":"20px"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"0"!=t.active,expression:"active!='0'"}],attrs:{type:"primary",plain:""},on:{click:function(e){return t.setsBut({type:"last"})}}},[t._v(" "+t._s(" << 上一步")+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"4"==t.active,expression:"active=='4'"}],attrs:{type:"primary"},on:{click:t.addGoods}},[t._v(" "+t._s("add"==t.addOpenType?"添加商品":"编辑商品")+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"4"!=t.active,expression:"active!='4'"}],attrs:{type:"primary",plain:""},on:{click:function(e){return t.setsBut({type:"next"})}}},[t._v(t._s("下一步 >>")+" ")])],1)],1)},r=[],o=(a("99af"),a("4160"),a("c975"),a("a15b"),a("a434"),a("b0c0"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("159b"),a("5530")),i=(a("96cf"),a("1da1")),s=a("aa34"),c=a("c40e"),u=a("25ae"),l=a.n(u),d={props:["goodsId","addOpenType"],components:{goodsCascaderCom:s["a"],ckEditor:l.a.component},data:function(){var t=this,e=function(e,a,n){a<1&&(t.ruleForm1[e.field]=1),n()};return{baseUrl:"http://localhost:8888/api/private/v1",urlTOkent:this.$store.state.token,active:0,resCasValue:[],ruleForm1:{goods_name:"",goods_price:"",goods_weight:"",goods_number:"",goods_cat:""},defaultList:[],pics:[],isUpload:!1,goods_introduce:"",manyAtt:[],onlyAtt:[],editConfig:{extraPlugins:"autogrow,editorplaceholder",autoGrow_minHeight:250,autoGrow_maxHeight:500,editorplaceholder:"请输入商品内容"},isManyRequest:!0,isOnlyRequest:!0,failImg:[],rules1:{goods_name:[{required:!0,message:"请输入商品名称!",trigger:"blur"},{max:50,message:"商品名称长度在50个字符内!",trigger:"change"}],goods_price:[{required:!0,message:"请输入商品价格!",trigger:"blur"},{type:"number",message:"商品价格必须为数字值!"},{validator:e,trigger:"change"}],goods_weight:[{required:!0,message:"请输入商品重量!",trigger:"blur"},{type:"number",message:"商品重量必须为数字值!"},{validator:e,trigger:"change"}],goods_number:[{required:!0,message:"请输入商品数量!",trigger:"blur"},{type:"number",message:"商品数量必须数字值!"},{validator:e,trigger:"change"}],goods_cat:[{required:!0,message:"请选择商品分类!",trigger:"change"}]},options:[],dataType:{expandTrigger:"hover",label:"cat_name",value:"cat_id",text:"请选择分类",show:!0}}},methods:{getIdGoods:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("edit"!=t.addOpenType){e.next=5;break}return e.next=3,Object(c["m"])(t.goodsId);case 3:a=e.sent,200==a.data.meta.status?(t.isManyRequest=!1,t.isOnlyRequest=!1,t.goods_introduce=a.data.data.goods_introduce,a.data.data.pics.forEach((function(e){var a=e.pics_big.split("/");e.name=a[a.length-1],e.url=e.pics_big_url,t.defaultList.push(e)})),n=Object.keys(t.ruleForm1),n.forEach((function(e){if(t.ruleForm1[e]=a.data.data[e],"goods_cat"==e){var n=a.data.data.goods_cat.split(",");n.forEach((function(t,e){n[e]=parseInt(t)})),t.resCasValue=n}})),0!=a.data.data.attrs.length&&a.data.data.attrs.forEach((function(e){"many"==e.attr_sel?t.manyAtt.push({attr_id:e.attr_id,attr_value:e.attr_vals.split(",")||[],attr_name:e.attr_name}):"only"==e.attr_sel&&t.onlyAtt.push({attr_id:e.attr_id,attr_value:e.attr_vals||"",attr_name:e.attr_name})}))):(t.$message.error("获取商品数据失败，请稍后重试！"),t.hideAddPage());case 5:case"end":return e.stop()}}),e)})))()},tabBeforeLeave:function(t,e){var a=this,n=!0;return"0"==e&&this.$refs["ruleForm"].validate((function(t){if(!t)return a.active=e,a.$message.error("请填写或选择必要参数!"),void(n=!1);a.isManyRequest&&a.getCategoriesAtt({sel:"many"}),a.isOnlyRequest&&a.getCategoriesAtt({sel:"only"})})),n},hideAddPage:function(){this.$emit("hidePage")},getCategoriesList:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["j"])();case 2:a=e.sent,200==a.data.meta.status&&(t.options=a.data.data);case 4:case"end":return e.stop()}}),e)})))()},getCategoriesAtt:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.ruleForm1.goods_cat.split(","),t.id=n[n.length-1],a.next=4,Object(c["k"])(t);case 4:r=a.sent,200==r.data.meta.status&&("many"==t.sel?(e.manyAtt=[],e.isManyRequest=!1):"only"==t.sel&&(e.onlyAtt=[],e.isOnlyRequest=!1),r.data.data.forEach((function(a){"many"==t.sel?e.manyAtt.push({attr_id:a.attr_id,attr_value:a.attr_vals.split(",")||[],attr_name:a.attr_name}):e.onlyAtt.push({attr_id:a.attr_id,attr_value:a.attr_vals||"",attr_name:a.attr_name})})));case 6:case"end":return a.stop()}}),a)})))()},goodsImgChange:function(t,e){var a=this;if("ready"==t.status){var n=t.name.split(".")[1];"jpg"!=n&&"png"!=n&&(e.splice(e.indexOf(t.uid,1)),this.$message.error("只能上传png或者jpg格式的图片！")),t.size/1034>500&&(e.splice(e.indexOf(t.uid,1)),this.$message.error("上传的图片大小不能超过500kb！")),e.forEach((function(n){n.name==t.name&&n.uid!=t.uid&&(e.splice(e.indexOf(t.uid,1)),a.$message.error("该图片已在上传的图片列表中！"))}))}},removeSuccGoods:function(t){var e=this;0!=this.defaultList.length&&this.defaultList.forEach((function(a,n){a.pice_id==t.pice_id&&e.defaultList.splice(n,1)}))},goodsImgError:function(t,e,a){this.failImg.push(e.name),0==a.length&&(this.$message.error("图片".concat(this.failImg.join("、"),"上传失败")),this.addRequest())},goodsImgSuccess:function(t,e,a){200==t.meta.status&&this.pics.push({pic:t.data.tmp_path}),e.uid==a[a.length-1].uid&&this.addRequest()},addGoods:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.failImg=[],e.next=3,t.$refs.goodsImgUpload.submit();case 3:t.isUpload||t.addRequest();case 4:case"end":return e.stop()}}),e)})))()},addRequest:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a={},n="",r=t.manyAtt.concat(t.onlyAtt),"add"!=t.addOpenType){e.next=10;break}return a=Object(o["a"])(Object(o["a"])(Object(o["a"])({},a),t.ruleForm1),{},{pics:t.pics,goods_introduce:t.goods_introduce,attrs:r}),e.next=7,Object(c["c"])(a);case 7:n=e.sent,e.next=16;break;case 10:if("edit"!=t.addOpenType){e.next=16;break}return i=t.defaultList.concat(t.pics),a=Object(o["a"])(Object(o["a"])(Object(o["a"])({},a),t.ruleForm1),{},{pics:i,goods_introduce:t.goods_introduce,attrs:r,id:t.goodsId}),e.next=15,Object(c["i"])(a);case 15:n=e.sent;case 16:201==n.data.meta.status||200==n.data.meta.status?(t.$message.success(n.data.meta.msg),t.$emit("hidePage"),t.$emit("updateGoods")):(t.$message.error(n.data.meta.msg),t.isUpload=!1);case 17:case"end":return e.stop()}}),e)})))()},casChange:function(t){if(0==t.length)this.ruleForm1.goods_cat="";else{var e=t.join(",");this.ruleForm1.goods_cat=e,this.isManyRequest=!0,this.isOnlyRequest=!0}},setsBut:function(t){t.value&&(this.active=t.value),t.type&&("last"==t.type?this.active=(parseInt(this.active)-1).toString():this.active=(parseInt(this.active)+1).toString())}},created:function(){this.getIdGoods(),this.getCategoriesList()}},p=d,m=(a("5fb9"),a("2877")),g=Object(m["a"])(p,n,r,!1,null,null,null);e["default"]=g.exports},"5fb9":function(t,e,a){"use strict";var n=a("0f53"),r=a.n(n);r.a},aa34:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.casOption?a("el-cascader",{ref:"myCas",attrs:{options:t.casOption,props:t.casDataType,placeholder:t.casDataType.text,"show-all-levels":t.casDataType.show,clearable:""},on:{change:t.handleChange},model:{value:t.addValue,callback:function(e){t.addValue=e},expression:"addValue"}}):t._e()},r=[],o={props:["casOption","casDataType","casValue"],data:function(){return{addValue:[]}},methods:{handleChange:function(t){this.$emit("clickValue",t)}},watch:{casValue:function(t){this.addValue=t}}},i=o,s=a("2877"),c=Object(s["a"])(i,n,r,!1,null,null,null);e["a"]=c.exports},c40e:function(t,e,a){"use strict";a.d(e,"l",(function(){return o})),a.d(e,"m",(function(){return i})),a.d(e,"c",(function(){return s})),a.d(e,"i",(function(){return c})),a.d(e,"e",(function(){return u})),a.d(e,"j",(function(){return l})),a.d(e,"k",(function(){return g})),a.d(e,"d",(function(){return f})),a.d(e,"g",(function(){return h})),a.d(e,"a",(function(){return v})),a.d(e,"f",(function(){return m})),a.d(e,"b",(function(){return d})),a.d(e,"h",(function(){return p}));a("99af");var n=a("5530"),r=a("b775");function o(t){return r["a"].get("goods",{params:Object(n["a"])({},t)})}function i(t){return r["a"].get("goods/".concat(t))}function s(t){return r["a"].post("goods",Object(n["a"])({},t))}function c(t){return r["a"].put("goods/".concat(t.id),Object(n["a"])({},t))}function u(t){return r["a"].delete("goods/".concat(t))}function l(t){return r["a"].get("categories",{params:{type:t}})}function d(t){return r["a"].post("categories",Object(n["a"])({},t))}function p(t){return r["a"].put("categories/".concat(t.cat_id),Object(n["a"])({},t))}function m(t){return r["a"].delete("categories/".concat(t))}function g(t){return r["a"].get("categories/".concat(t.id,"/attributes"),{params:Object(n["a"])({},t)})}function f(t){return r["a"].delete("categories/".concat(t.id,"/attributes/").concat(t.attrid))}function h(t){return r["a"].put("categories/".concat(t.cat_id,"/attributes/").concat(t.attr_id),Object(n["a"])({},t))}function v(t){return r["a"].post("categories/".concat(t.cat_id,"/attributes"),Object(n["a"])({},t))}}}]);